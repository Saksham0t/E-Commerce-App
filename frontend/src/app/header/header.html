@if (showHeader) {
<nav class="mainheader navbar navbar-expand-lg navbar-dark bg-dark px-4 fixed-top">
  <a class="navbar-brand d-flex align-items-center" routerLink="/home" (click)="activeCategory = null">
    <img
      src="logo.png"
      alt="Logo"
      class="me-2"
      style="height: 75px; width: 75px; margin-top: -13px; margin-bottom: -13px"
    />
    <span class="fw-bold fs-4">Matrix</span>
  </a>

  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarContent">
    <!-- Search Bar -->
    <form class="d-flex mx-auto w-50 align-items-start position-relative">
      <div class="w-100 position-relative">
        <input
          class="form-control rounded-pill shadow-sm border-0 px-3"
          type="search"
          placeholder="ðŸ” Search for products..."
          aria-label="Search"
          [(ngModel)]="search"
          (input)="updateSuggestions()"
          name="search"
          autocomplete="off"
        />
        @if (suggestions.length > 0) {
        <ul class="list-group position-absolute w-100 mt-2 bg-white shadow rounded" style="z-index: 1050">
          @for (suggestion of suggestions; track $index) {
          <li class="list-group-item list-group-item-action" (click)="selectSuggestion(suggestion)">
            {{ suggestion }}
          </li>
          }
        </ul>
        }
      </div>

      <button class="btn btn-light rounded-pill px-4 shadow-sm ms-2" type="button" (click)="searchNow()">
        Search
      </button>

      <!-- Toggle Categories Arrow -->
      <button
        type="button"
        class="btn btn-light ms-2 d-flex align-items-center justify-content-center"
        style="width: 28px; height: 28px; border-radius: 50%; margin-top: 4px"
        (click)="toggleCategories()"
        title="Show Categories"
      >
        <i class="bi" [ngClass]="{ 'bi-chevron-down': !showCategories, 'bi-chevron-up': showCategories }"></i>
      </button>
    </form>

    <ul class="navbar-nav ms-auto mb-2 mb-lg-0 align-items-lg-center">
      @if (!isLoggedIn) {
      <li class="nav-item me-lg-4">
        <a (click)="openLogin()" class="btn btn-outline-light border-0 fw-semibold shadow-sm" style="cursor: pointer">
          <i class="bi bi-box-arrow-in-right me-1"></i> Login
        </a>
      </li>
      }

      @if (isLoggedIn) {
      <!-- Cart -->
      <li class="nav-item me-lg-4">
        <a class="nav-link d-flex align-items-center" (click)="activeCategory = null" routerLink="/cart">
          <span class="position-relative me-1">
            <img
              src="https://cdn-icons-png.flaticon.com/512/1170/1170678.png"
              alt="Cart"
              width="25"
              style="filter: brightness(0) invert(1)"
            />
            @if (cartCount > 0) {
            <span class="badge bg-danger position-absolute top-0 start-100 translate-middle">
              {{ cartCount }}
            </span>
            }
          </span>
          Cart
        </a>
      </li>

      <!-- Profile Dropdown -->
      <li class="nav-item dropdown">
        <a
          class="nav-link dropdown-toggle d-flex align-items-center"
          href="#"
          id="profileDropdown"
          role="button"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          <i class="bi bi-person-circle me-2 fs-5"></i>
          {{ userName }}
        </a>
        <ul class="dropdown-menu dropdown-menu-end shadow-lg border-0 rounded-3" aria-labelledby="profileDropdown">
          <li>
            <a class="dropdown-item py-2" routerLink="/my-profile">
              <i class="bi bi-person-lines-fill me-2 text-primary"></i> My Profile
            </a>
          </li>
          <li>
            <a class="dropdown-item py-2" routerLink="/view-orders">
              <i class="bi bi-bag-check-fill me-2 text-success"></i> My Orders
            </a>
          </li>
          <li>
            <a class="dropdown-item py-2" routerLink="/admin-login">
              <i class="bi bi-shield-lock-fill me-2 text-warning"></i> Admin Login
            </a>
          </li>
          <li><hr class="dropdown-divider" /></li>
          <li class="text-center">
            <a class="dropdown-item logout-item py-1 text-danger fw-bold cursor-pointer" (click)="logout()">
              <i class="bi bi-box-arrow-right me-2"></i> Logout
            </a>
          </li>
        </ul>
      </li>
      }
    </ul>
  </div>
</nav>

<!-- Categories Bar -->
@if (showCategories) {
<div class="categories-bar text-white bg-dark shadow-sm fixed-top" style="background-color: rgb(70, 44, 18)">
  <div class="container py-2">
    <ul class="nav justify-content-center flex-wrap gap-3">
      @for (cat of categories; track $index) {
      <li class="nav-item">
        <a
          class="nav-link category-pill"
          [class.active-category]="activeCategory === cat"
          (click)="filterByCategory(cat)"
        >
          {{ cat }}
        </a>
      </li>
      }
    </ul>
  </div>
</div>
}
}

@if (isNotAdminRoute()) {
<div style="padding-top: 100px">
  <router-outlet></router-outlet>
</div>
} @else {
<div>
  <router-outlet></router-outlet>
</div>
}
